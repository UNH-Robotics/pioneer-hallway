Scott's code:
https://drive.google.com/open?id=0B30-wMNUWhbgNndRRWFJNlF5SGM

Kasra's code:
https://drive.google.com/open?id=0B30-wMNUWhbgbjd6WDVuZ1E2NWM